function a14_0x264a(){const _0x11c2c2=['Fkart','1125065NSPOSQ','Fktyp','Posnr','Kursk','Matkl','../config/db','Vbeln','Gjahr','Fkimg','query','OdrVal','9951732SYeVXB','MonthD','Vtweg','error','Aupos','Int','Data\x20inserted/updated\x20successfully.','Transaction','PendingQty','Kunnr','commit','Kwmeng',',\x20Posnr=','VarChar','Netwr','1768512BQYBHF','request','Matnr','42012984aEnUUM','Zone','message','❌\x20Transaction\x20failed:','244380pcqnwa','Aubel','Decimal','Vkorg','✅\x20All\x20records\x20upserted\x20successfully.','MonthDesc','begin','exports','Spart','1490331bOlnSZ','No\x20data\x20provided\x20for\x20upsertion.','input','🔄\x20Processing\x20Last\x20Month\x20Carry:','Error\x20inserting/updating\x20data','794359DFVaZH','16eBDhTh','log','❌\x20Error\x20processing\x20','Waerk','⚠️\x20No\x20Last\x20Month\x20Carry\x20data\x20to\x20process.','warn'];a14_0x264a=function(){return _0x11c2c2;};return a14_0x264a();}const a14_0x2ce4b2=a14_0x2d0a;function a14_0x2d0a(_0x4af528,_0x55ae99){const _0x264af0=a14_0x264a();return a14_0x2d0a=function(_0x2d0a70,_0x5cee62){_0x2d0a70=_0x2d0a70-0x81;let _0xaf7034=_0x264af0[_0x2d0a70];return _0xaf7034;},a14_0x2d0a(_0x4af528,_0x55ae99);}(function(_0x259ba3,_0x1cc7bf){const _0x2614b7=a14_0x2d0a,_0x261dde=_0x259ba3();while(!![]){try{const _0x489ce9=-parseInt(_0x2614b7(0x8e))/0x1+-parseInt(_0x2614b7(0xb0))/0x2+-parseInt(_0x2614b7(0x89))/0x3+-parseInt(_0x2614b7(0x8f))/0x4*(parseInt(_0x2614b7(0x96))/0x5)+parseInt(_0x2614b7(0xb7))/0x6+-parseInt(_0x2614b7(0xa1))/0x7+parseInt(_0x2614b7(0xb3))/0x8;if(_0x489ce9===_0x1cc7bf)break;else _0x261dde['push'](_0x261dde['shift']());}catch(_0x18aba7){_0x261dde['push'](_0x261dde['shift']());}}}(a14_0x264a,0xc2261));const {sql,poolPromise}=require(a14_0x2ce4b2(0x9b)),parseDecimal=_0x4ad901=>{if(!_0x4ad901||isNaN(_0x4ad901))return 0x0;return parseFloat(_0x4ad901);},insertOrUpdateLastMonthCarry=async _0x29c584=>{const _0xb4a1d2=a14_0x2ce4b2;if(!_0x29c584||_0x29c584['length']===0x0)return console[_0xb4a1d2(0x94)](_0xb4a1d2(0x93)),{'success':![],'message':_0xb4a1d2(0x8a)};try{const _0x510733=await poolPromise,_0x28c8ce=new sql[(_0xb4a1d2(0xa8))](_0x510733);await _0x28c8ce[_0xb4a1d2(0x86)]();for(const _0x4b4cfa of _0x29c584){try{console[_0xb4a1d2(0x90)](_0xb4a1d2(0x8c),_0x4b4cfa['Vbeln'],_0x4b4cfa[_0xb4a1d2(0x98)]),await _0x28c8ce[_0xb4a1d2(0xb1)]()['input']('Vbeln',sql[_0xb4a1d2(0xae)],_0x4b4cfa[_0xb4a1d2(0x9c)])[_0xb4a1d2(0x8b)]('Posnr',sql[_0xb4a1d2(0xae)],_0x4b4cfa[_0xb4a1d2(0x98)])[_0xb4a1d2(0x8b)](_0xb4a1d2(0xa3),sql[_0xb4a1d2(0xae)],_0x4b4cfa[_0xb4a1d2(0xa3)]||'')[_0xb4a1d2(0x8b)](_0xb4a1d2(0x88),sql[_0xb4a1d2(0xae)],_0x4b4cfa[_0xb4a1d2(0x88)]||'')[_0xb4a1d2(0x8b)](_0xb4a1d2(0x95),sql['VarChar'],_0x4b4cfa[_0xb4a1d2(0x95)]||'')[_0xb4a1d2(0x8b)](_0xb4a1d2(0x97),sql[_0xb4a1d2(0xae)],_0x4b4cfa[_0xb4a1d2(0x97)]||'')['input'](_0xb4a1d2(0x83),sql[_0xb4a1d2(0xae)],_0x4b4cfa['Vkorg']||'')[_0xb4a1d2(0x8b)]('Waerk',sql['VarChar'],_0x4b4cfa[_0xb4a1d2(0x92)]||'')[_0xb4a1d2(0x8b)](_0xb4a1d2(0x9d),sql[_0xb4a1d2(0xa6)],parseInt(_0x4b4cfa[_0xb4a1d2(0x9d)])||null)['input'](_0xb4a1d2(0x81),sql[_0xb4a1d2(0xae)],_0x4b4cfa[_0xb4a1d2(0x81)]||'')[_0xb4a1d2(0x8b)](_0xb4a1d2(0xa5),sql[_0xb4a1d2(0xae)],_0x4b4cfa[_0xb4a1d2(0xa5)]||'')['input']('Netwr',sql['Decimal'](0x12,0x2),parseDecimal(_0x4b4cfa[_0xb4a1d2(0xaf)]))[_0xb4a1d2(0x8b)](_0xb4a1d2(0xb2),sql['VarChar'],_0x4b4cfa['Matnr']||'')[_0xb4a1d2(0x8b)](_0xb4a1d2(0x9e),sql[_0xb4a1d2(0x82)](0x12,0x3),parseDecimal(_0x4b4cfa[_0xb4a1d2(0x9e)]))['input'](_0xb4a1d2(0x9a),sql[_0xb4a1d2(0xae)],_0x4b4cfa['Matkl']||'')[_0xb4a1d2(0x8b)](_0xb4a1d2(0xac),sql[_0xb4a1d2(0x82)](0x12,0x3),parseDecimal(_0x4b4cfa[_0xb4a1d2(0xac)]))[_0xb4a1d2(0x8b)](_0xb4a1d2(0xa9),sql[_0xb4a1d2(0x82)](0x12,0x3),parseDecimal(_0x4b4cfa['PendingQty']))[_0xb4a1d2(0x8b)](_0xb4a1d2(0xa0),sql[_0xb4a1d2(0x82)](0x12,0x2),parseDecimal(_0x4b4cfa['OdrVal']))[_0xb4a1d2(0x8b)](_0xb4a1d2(0xaa),sql[_0xb4a1d2(0xae)],_0x4b4cfa['Kunnr']||'')[_0xb4a1d2(0x8b)](_0xb4a1d2(0x99),sql[_0xb4a1d2(0x82)](0x12,0x5),parseDecimal(_0x4b4cfa[_0xb4a1d2(0x99)]))[_0xb4a1d2(0x8b)]('Bzirk',sql[_0xb4a1d2(0xae)],_0x4b4cfa['Bzirk']||'')[_0xb4a1d2(0x8b)](_0xb4a1d2(0xb4),sql[_0xb4a1d2(0xae)],_0x4b4cfa['Zone']||'')[_0xb4a1d2(0x8b)](_0xb4a1d2(0xa2),sql[_0xb4a1d2(0xae)],_0x4b4cfa[_0xb4a1d2(0xa2)]||'')[_0xb4a1d2(0x8b)](_0xb4a1d2(0x85),sql['VarChar'](0x14),_0x4b4cfa['MonthDesc']||'')[_0xb4a1d2(0x9f)]('\x0a\x20\x20MERGE\x20INTO\x20PRD_LastMonthCarry\x20AS\x20target\x0a\x20\x20USING\x20(SELECT\x20@Vbeln\x20AS\x20Vbeln,\x20@Posnr\x20AS\x20Posnr)\x20AS\x20source\x0a\x20\x20ON\x20target.Vbeln\x20=\x20source.Vbeln\x20AND\x20target.Posnr\x20=\x20source.Posnr\x0a\x20\x20WHEN\x20MATCHED\x20THEN\x0a\x20\x20\x20\x20UPDATE\x20SET\x0a\x20\x20\x20\x20\x20\x20Vtweg\x20=\x20@Vtweg,\x0a\x20\x20\x20\x20\x20\x20Spart\x20=\x20@Spart,\x0a\x20\x20\x20\x20\x20\x20Fkart\x20=\x20@Fkart,\x0a\x20\x20\x20\x20\x20\x20Fktyp\x20=\x20@Fktyp,\x0a\x20\x20\x20\x20\x20\x20Vkorg\x20=\x20@Vkorg,\x0a\x20\x20\x20\x20\x20\x20Waerk\x20=\x20@Waerk,\x0a\x20\x20\x20\x20\x20\x20Gjahr\x20=\x20@Gjahr,\x0a\x20\x20\x20\x20\x20\x20Aubel\x20=\x20@Aubel,\x0a\x20\x20\x20\x20\x20\x20Aupos\x20=\x20@Aupos,\x0a\x20\x20\x20\x20\x20\x20Netwr\x20=\x20@Netwr,\x0a\x20\x20\x20\x20\x20\x20Matnr\x20=\x20@Matnr,\x0a\x20\x20\x20\x20\x20\x20Fkimg\x20=\x20@Fkimg,\x0a\x20\x20\x20\x20\x20\x20Matkl\x20=\x20@Matkl,\x0a\x20\x20\x20\x20\x20\x20Kwmeng\x20=\x20@Kwmeng,\x0a\x20\x20\x20\x20\x20\x20PendingQty\x20=\x20@PendingQty,\x0a\x20\x20\x20\x20\x20\x20OdrVal\x20=\x20@OdrVal,\x0a\x20\x20\x20\x20\x20\x20Kunnr\x20=\x20@Kunnr,\x0a\x20\x20\x20\x20\x20\x20Kursk\x20=\x20@Kursk,\x0a\x20\x20\x20\x20\x20\x20Bzirk\x20=\x20@Bzirk,\x0a\x20\x20\x20\x20\x20\x20Zone\x20=\x20@Zone,\x0a\x20\x20\x20\x20\x20\x20MonthD\x20=\x20@MonthD,\x0a\x20\x20\x20\x20\x20\x20MonthDesc\x20=\x20@MonthDesc\x0a\x20\x20WHEN\x20NOT\x20MATCHED\x20THEN\x0a\x20\x20\x20\x20INSERT\x20(\x0a\x20\x20\x20\x20\x20\x20Vbeln,\x20Posnr,\x20Vtweg,\x20Spart,\x20Fkart,\x20Fktyp,\x20Vkorg,\x20Waerk,\x0a\x20\x20\x20\x20\x20\x20Gjahr,\x20Aubel,\x20Aupos,\x20Netwr,\x20Matnr,\x20Fkimg,\x20Matkl,\x0a\x20\x20\x20\x20\x20\x20Kwmeng,\x20PendingQty,\x20OdrVal,\x20Kunnr,\x20Kursk,\x20Bzirk,\x20Zone,\x20MonthD,\x20MonthDesc\x0a\x20\x20\x20\x20)\x0a\x20\x20\x20\x20VALUES\x20(\x0a\x20\x20\x20\x20\x20\x20@Vbeln,\x20@Posnr,\x20@Vtweg,\x20@Spart,\x20@Fkart,\x20@Fktyp,\x20@Vkorg,\x20@Waerk,\x0a\x20\x20\x20\x20\x20\x20@Gjahr,\x20@Aubel,\x20@Aupos,\x20@Netwr,\x20@Matnr,\x20@Fkimg,\x20@Matkl,\x0a\x20\x20\x20\x20\x20\x20@Kwmeng,\x20@PendingQty,\x20@OdrVal,\x20@Kunnr,\x20@Kursk,\x20@Bzirk,\x20@Zone,\x20@MonthD,\x20@MonthDesc\x0a\x20\x20\x20\x20);\x0a'),console['log']('✅\x20Upserted:\x20Vbeln='+_0x4b4cfa['Vbeln']+_0xb4a1d2(0xad)+_0x4b4cfa['Posnr']);}catch(_0x2cde07){console[_0xb4a1d2(0xa4)](_0xb4a1d2(0x91)+_0x4b4cfa[_0xb4a1d2(0x9c)]+'-'+_0x4b4cfa[_0xb4a1d2(0x98)]+':',_0x2cde07[_0xb4a1d2(0xb5)]);}}return await _0x28c8ce[_0xb4a1d2(0xab)](),console[_0xb4a1d2(0x90)](_0xb4a1d2(0x84)),{'success':!![],'message':_0xb4a1d2(0xa7)};}catch(_0xe3bc0){return console[_0xb4a1d2(0xa4)](_0xb4a1d2(0xb6),_0xe3bc0),{'success':![],'message':_0xb4a1d2(0x8d),'error':_0xe3bc0};}};module[a14_0x2ce4b2(0x87)]={'insertOrUpdateLastMonthCarry':insertOrUpdateLastMonthCarry};