const a12_0x2dd4cc=a12_0x39a0;(function(_0x39b35d,_0x45634d){const _0x42b4c0=a12_0x39a0,_0x2cbbf6=_0x39b35d();while(!![]){try{const _0x3c03ee=parseInt(_0x42b4c0(0xe1))/0x1+parseInt(_0x42b4c0(0xbd))/0x2*(-parseInt(_0x42b4c0(0xdc))/0x3)+parseInt(_0x42b4c0(0xcf))/0x4*(parseInt(_0x42b4c0(0xc1))/0x5)+-parseInt(_0x42b4c0(0xf1))/0x6*(parseInt(_0x42b4c0(0xd8))/0x7)+parseInt(_0x42b4c0(0xe2))/0x8*(-parseInt(_0x42b4c0(0xbb))/0x9)+parseInt(_0x42b4c0(0xc9))/0xa*(parseInt(_0x42b4c0(0xc8))/0xb)+-parseInt(_0x42b4c0(0xde))/0xc;if(_0x3c03ee===_0x45634d)break;else _0x2cbbf6['push'](_0x2cbbf6['shift']());}catch(_0x5e36b4){_0x2cbbf6['push'](_0x2cbbf6['shift']());}}}(a12_0x11d6,0x5f524));function a12_0x39a0(_0x5070f6,_0x5d8fef){const _0x11d63f=a12_0x11d6();return a12_0x39a0=function(_0x39a091,_0x46693c){_0x39a091=_0x39a091-0xb7;let _0x1f9673=_0x11d63f[_0x39a091];return _0x1f9673;},a12_0x39a0(_0x5070f6,_0x5d8fef);}function a12_0x11d6(){const _0x203dfc=['DateTime','../config/db','5898PgMCDv','Data\x20inserted/updated\x20successfully','Werks','Vbeln','Totalinvoice','2826MPynJo','commit','10LWeBDK',',\x20Posnr=','Kunag','length','1317730sjVzha','match','PlannedOrder','request','Netwr','1900-01-01T00:00:00','Fkdat','125741EdlIhC','230OywcfC','Transaction','Aupos','‚ö†Ô∏è\x20No\x20sales\x20invoice\x20data\x20to\x20insert\x20or\x20update.','Matnr','Bzirk','4eWXsSm','message','Int','Matkl','input','Spart','error','‚ùå\x20Transaction\x20Failed:','Posnr','966cPyTLM','Gjahr','Decimal','toString','3573GGFIwx','üîç\x20Processing\x20Invoice:','3125256AZuyTa','‚úÖ\x20All\x20sales\x20invoices\x20upserted\x20successfully.','warn','665118dSrquh','10168cNLfyf','Waerk','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20MERGE\x20INTO\x20PRD_SalesInvoice\x20AS\x20target\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20USING\x20(SELECT\x20@Vbeln\x20AS\x20Vbeln,\x20@Posnr\x20AS\x20Posnr)\x20AS\x20source\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20target.Vbeln\x20=\x20source.Vbeln\x20AND\x20target.Posnr\x20=\x20source.Posnr\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20MATCHED\x20THEN\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20SET\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Matnr\x20=\x20@Matnr,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20PlannedOrder\x20=\x20@PlannedOrder,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Wgbez\x20=\x20@Wgbez,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Bzirk\x20=\x20@Bzirk,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Netwr\x20=\x20@Netwr,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Vtweg\x20=\x20@Vtweg,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Matkl\x20=\x20@Matkl,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20TotalInvoice\x20=\x20@TotalInvoice,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Spart\x20=\x20@Spart,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Zone\x20=\x20@Zone,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Fkart\x20=\x20@Fkart,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Kunag\x20=\x20@Kunag,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Fktyp\x20=\x20@Fktyp,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Aupos\x20=\x20@Aupos,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Werks\x20=\x20@Werks,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Vkorg\x20=\x20@Vkorg,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Waerk\x20=\x20@Waerk,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Gjahr\x20=\x20@Gjahr,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Fkdat\x20=\x20@Fkdat,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Aubel\x20=\x20@Aubel\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20NOT\x20MATCHED\x20THEN\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INSERT\x20(Vbeln,\x20Posnr,\x20Matnr,\x20PlannedOrder,\x20Wgbez,\x20Bzirk,\x20Netwr,\x20Vtweg,\x20Matkl,\x20TotalInvoice,\x20Spart,\x20Zone,\x20Fkart,\x20Kunag,\x20Fktyp,\x20Aupos,\x20Werks,\x20Vkorg,\x20Waerk,\x20Gjahr,\x20Fkdat,\x20Aubel)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(@Vbeln,\x20@Posnr,\x20@Matnr,\x20@PlannedOrder,\x20@Wgbez,\x20@Bzirk,\x20@Netwr,\x20@Vtweg,\x20@Matkl,\x20@TotalInvoice,\x20@Spart,\x20@Zone,\x20@Fkart,\x20@Kunag,\x20@Fktyp,\x20@Aupos,\x20@Werks,\x20@Vkorg,\x20@Waerk,\x20@Gjahr,\x20@Fkdat,\x20@Aubel);\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Vtweg','VarChar','begin','Zone','log','Wgbez','Aubel','Fkart','Vkorg','Fktyp'];a12_0x11d6=function(){return _0x203dfc;};return a12_0x11d6();}const {sql,poolPromise}=require(a12_0x2dd4cc(0xf0)),convertSAPDateTime=_0x1210ac=>{const _0x2cb2d2=a12_0x2dd4cc;if(!_0x1210ac||!_0x1210ac[_0x2cb2d2(0xc2)](/\d+/))return new Date(_0x2cb2d2(0xc6));const _0x4a8559=parseInt(_0x1210ac[_0x2cb2d2(0xc2)](/\d+/)[0x0],0xa);return new Date(_0x4a8559);},convertToDecimal=_0xe10b90=>{const _0x3eb1a6=a12_0x2dd4cc;if(!_0xe10b90||isNaN(_0xe10b90))return 0x0;return parseFloat(_0xe10b90[_0x3eb1a6(0xdb)]()['replace'](',','.'));},insertOrUpdateSalesInvoices=async _0xec1bae=>{const _0x2e1d2e=a12_0x2dd4cc;if(!_0xec1bae||_0xec1bae[_0x2e1d2e(0xc0)]===0x0)return console[_0x2e1d2e(0xe0)](_0x2e1d2e(0xcc)),{'success':![],'message':'No\x20data\x20provided\x20for\x20upsertion'};try{const _0x460984=await poolPromise,_0x13d06a=new sql[(_0x2e1d2e(0xca))](_0x460984);await _0x13d06a[_0x2e1d2e(0xe7)]();for(let _0x437e40 of _0xec1bae){try{console[_0x2e1d2e(0xe9)](_0x2e1d2e(0xdd),_0x437e40[_0x2e1d2e(0xb9)],_0x437e40[_0x2e1d2e(0xd7)]),await _0x13d06a[_0x2e1d2e(0xc4)]()[_0x2e1d2e(0xd3)](_0x2e1d2e(0xb9),sql[_0x2e1d2e(0xe6)],_0x437e40[_0x2e1d2e(0xb9)])[_0x2e1d2e(0xd3)](_0x2e1d2e(0xd7),sql[_0x2e1d2e(0xe6)],_0x437e40[_0x2e1d2e(0xd7)])['input'](_0x2e1d2e(0xcd),sql['VarChar'],_0x437e40[_0x2e1d2e(0xcd)])[_0x2e1d2e(0xd3)](_0x2e1d2e(0xc3),sql[_0x2e1d2e(0xda)](0x12,0x3),parseFloat(_0x437e40['PlannedOrder'])||0x0)['input'](_0x2e1d2e(0xea),sql['VarChar'],_0x437e40[_0x2e1d2e(0xea)])[_0x2e1d2e(0xd3)](_0x2e1d2e(0xce),sql[_0x2e1d2e(0xe6)],_0x437e40[_0x2e1d2e(0xce)])['input'](_0x2e1d2e(0xc5),sql[_0x2e1d2e(0xda)](0x12,0x2),parseFloat(_0x437e40[_0x2e1d2e(0xc5)])||0x0)['input'](_0x2e1d2e(0xe5),sql[_0x2e1d2e(0xe6)],_0x437e40['Vtweg'])[_0x2e1d2e(0xd3)](_0x2e1d2e(0xd2),sql['VarChar'],_0x437e40[_0x2e1d2e(0xd2)])['input'](_0x2e1d2e(0xba),sql[_0x2e1d2e(0xda)](0x12,0x3),parseFloat(_0x437e40['Totalinvoice'])||0x0)[_0x2e1d2e(0xd3)](_0x2e1d2e(0xd4),sql['VarChar'],_0x437e40['Spart'])[_0x2e1d2e(0xd3)](_0x2e1d2e(0xe8),sql[_0x2e1d2e(0xe6)],_0x437e40['Zone'])['input'](_0x2e1d2e(0xec),sql[_0x2e1d2e(0xe6)],_0x437e40[_0x2e1d2e(0xec)])[_0x2e1d2e(0xd3)](_0x2e1d2e(0xbf),sql[_0x2e1d2e(0xe6)],_0x437e40[_0x2e1d2e(0xbf)])[_0x2e1d2e(0xd3)](_0x2e1d2e(0xee),sql['VarChar'],_0x437e40[_0x2e1d2e(0xee)])[_0x2e1d2e(0xd3)](_0x2e1d2e(0xcb),sql[_0x2e1d2e(0xe6)],_0x437e40[_0x2e1d2e(0xcb)])['input'](_0x2e1d2e(0xb8),sql['VarChar'],_0x437e40[_0x2e1d2e(0xb8)])[_0x2e1d2e(0xd3)](_0x2e1d2e(0xed),sql['VarChar'],_0x437e40['Vkorg'])[_0x2e1d2e(0xd3)](_0x2e1d2e(0xe3),sql[_0x2e1d2e(0xe6)],_0x437e40['Waerk'])[_0x2e1d2e(0xd3)](_0x2e1d2e(0xd9),sql[_0x2e1d2e(0xd1)],parseInt(_0x437e40['Gjahr'])||null)[_0x2e1d2e(0xd3)](_0x2e1d2e(0xc7),sql[_0x2e1d2e(0xef)],_0x437e40['Fkdat'])[_0x2e1d2e(0xd3)](_0x2e1d2e(0xeb),sql[_0x2e1d2e(0xe6)],_0x437e40[_0x2e1d2e(0xeb)])['query'](_0x2e1d2e(0xe4)),console[_0x2e1d2e(0xe9)]('‚úÖ\x20Upserted:\x20Vbeln='+_0x437e40[_0x2e1d2e(0xb9)]+_0x2e1d2e(0xbe)+_0x437e40[_0x2e1d2e(0xd7)]);}catch(_0x3cdfd7){console[_0x2e1d2e(0xd5)]('‚ùå\x20Failed\x20to\x20process\x20invoice\x20'+_0x437e40['Vbeln']+'-'+_0x437e40['Posnr']+':',_0x3cdfd7[_0x2e1d2e(0xd0)]);}}return await _0x13d06a[_0x2e1d2e(0xbc)](),console[_0x2e1d2e(0xe9)](_0x2e1d2e(0xdf)),{'success':!![],'message':_0x2e1d2e(0xb7)};}catch(_0x37d8c3){return console[_0x2e1d2e(0xd5)](_0x2e1d2e(0xd6),_0x37d8c3),{'success':![],'message':'Error\x20inserting/updating\x20data','error':_0x37d8c3};}};module['exports']={'insertOrUpdateSalesInvoices':insertOrUpdateSalesInvoices};