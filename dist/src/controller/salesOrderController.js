const a6_0x5c7fc1=a6_0x10fc;function a6_0x3a59(){const _0x40ce4c=['isArray','getDate','failedRows','16090EtYAkV','üîç\x20Fetching\x20Sales\x20Order\x20Data\x20from\x20API:','object','‚úÖ\x20Sales\x20order\x20data\x20inserted/updated\x20successfully','PlannedOrder','warn','0.00','454123Rtizmi','3481136SwYejS','Vbeln','get','5753ZbbBHy','Bzirk','üöÄ\x20Starting\x20Sales\x20Order\x20Data\x20Sync...','toString','‚úÖ\x20API\x20Response\x20Received.\x20Length:','error','Kunnr','json','slice','padStart','‚ùå\x20API\x20Response\x20Format\x20Incorrect:','message','‚ö†Ô∏è\x20Received\x20empty\x20response\x20from\x20API','dotenv','Vtext','‚úÖ\x20Sales\x20Order\x20Data\x20Sync\x20Completed\x20Successfully','65XTCbik','‚ùå\x20Skipping\x20invalid\x20entry\x20at\x20index\x20','Posnr','5903100kTouTf','üì¶\x20Received\x20','Matnr','Kursk','../models/salesOrderModel','getMinutes','getHours','length','Zone','Wgbez','env','match','14YoLOuJ','2613714pifmFN','Sales_Order_API','results','Erdat','Internal\x20Server\x20Error','Invalid\x20data\x20format\x20received\x20from\x20SAP','SAP_PASSWORD','üìå\x20API\x20Response\x20Data:','SAP_USERNAME','Database\x20error\x20occurred\x20while\x20inserting/updating\x20sales\x20orders.','status','‚ùå\x20Error\x20fetching\x20SAP\x20sales\x20order\x20data:','toFixed','exports','getMonth','SAP\x20API\x20Error:\x20','application/json','2etwMDQ','stringify','Error\x20inserting\x20or\x20updating\x20sales\x20order\x20data','processedRows','log','‚ùå\x20Error\x20processing\x20sales\x20order\x20data:','87738PUmgZm','3440536kpGqMJ','Spart','data','Vtweg','string','filter','üìå\x20Final\x20Data\x20Before\x20Insert/Update:','Empty\x20response\x20from\x20API'];a6_0x3a59=function(){return _0x40ce4c;};return a6_0x3a59();}function a6_0x10fc(_0x4e9f59,_0x59a61c){const _0x3a5922=a6_0x3a59();return a6_0x10fc=function(_0x10fc0e,_0x4bbb8e){_0x10fc0e=_0x10fc0e-0x17e;let _0x134ed9=_0x3a5922[_0x10fc0e];return _0x134ed9;},a6_0x10fc(_0x4e9f59,_0x59a61c);}(function(_0x4f24e7,_0x433887){const _0x317ad0=a6_0x10fc,_0x4bbd53=_0x4f24e7();while(!![]){try{const _0x1dd274=-parseInt(_0x317ad0(0x18d))/0x1+parseInt(_0x317ad0(0x1c2))/0x2*(parseInt(_0x317ad0(0x1b1))/0x3)+parseInt(_0x317ad0(0x18e))/0x4+parseInt(_0x317ad0(0x1a1))/0x5*(-parseInt(_0x317ad0(0x1c8))/0x6)+parseInt(_0x317ad0(0x1b0))/0x7*(parseInt(_0x317ad0(0x1c9))/0x8)+-parseInt(_0x317ad0(0x1a4))/0x9+parseInt(_0x317ad0(0x186))/0xa*(-parseInt(_0x317ad0(0x191))/0xb);if(_0x1dd274===_0x433887)break;else _0x4bbd53['push'](_0x4bbd53['shift']());}catch(_0x2033a5){_0x4bbd53['push'](_0x4bbd53['shift']());}}}(a6_0x3a59,0x704fb));const axios=require('axios'),{insertOrUpdateSalesOrders}=require(a6_0x5c7fc1(0x1a8));require(a6_0x5c7fc1(0x19e))['config']();const API_URL=process[a6_0x5c7fc1(0x1ae)][a6_0x5c7fc1(0x1b2)],convertSAPDateTime=_0x480835=>{const _0x3249f1=a6_0x5c7fc1;if(!_0x480835||typeof _0x480835!==_0x3249f1(0x17f))return null;const _0x1dee45=_0x480835[_0x3249f1(0x1af)](/\/Date\((\d+)(?:[+-]\d+)?\)\//);if(!_0x1dee45)return null;const _0x3cd40c=parseInt(_0x1dee45[0x1],0xa),_0x3bf0e8=new Date(_0x3cd40c),_0xee42c=_0x49acf4=>_0x49acf4[_0x3249f1(0x194)]()[_0x3249f1(0x19a)](0x2,'0'),_0xc3f8bb=_0x3bf0e8['getFullYear']()+'-'+_0xee42c(_0x3bf0e8[_0x3249f1(0x1bf)]()+0x1)+'-'+_0xee42c(_0x3bf0e8[_0x3249f1(0x184)]())+'\x20'+(_0xee42c(_0x3bf0e8[_0x3249f1(0x1aa)]())+':'+_0xee42c(_0x3bf0e8[_0x3249f1(0x1a9)]())+':'+_0xee42c(_0x3bf0e8['getSeconds']()));return _0xc3f8bb;},convertToDecimal=_0x25203c=>{const _0x5a4c32=a6_0x5c7fc1;if(!_0x25203c||isNaN(_0x25203c))return _0x5a4c32(0x18c);return parseFloat(_0x25203c['toString']()['replace'](',','.'))[_0x5a4c32(0x1bd)](0x2);},fetchSAPSalesOrders=async()=>{const _0x5242f7=a6_0x5c7fc1;try{console[_0x5242f7(0x1c6)](_0x5242f7(0x187),API_URL);const _0x405308=await axios[_0x5242f7(0x190)](API_URL,{'auth':{'username':process[_0x5242f7(0x1ae)][_0x5242f7(0x1b9)],'password':process[_0x5242f7(0x1ae)][_0x5242f7(0x1b7)]},'headers':{'Accept':_0x5242f7(0x1c1)}});if(!_0x405308[_0x5242f7(0x1cb)]){console[_0x5242f7(0x18b)](_0x5242f7(0x19d));throw new Error(_0x5242f7(0x182));}return console['log'](_0x5242f7(0x195),JSON[_0x5242f7(0x1c3)](_0x405308[_0x5242f7(0x1cb)])[_0x5242f7(0x1ab)]),console[_0x5242f7(0x1c6)](_0x5242f7(0x1b8),JSON[_0x5242f7(0x1c3)](_0x405308[_0x5242f7(0x1cb)],null,0x2)),_0x405308['data'];}catch(_0x296686){console[_0x5242f7(0x196)](_0x5242f7(0x1bc),_0x296686['message']);throw new Error(_0x5242f7(0x1c0)+_0x296686[_0x5242f7(0x19c)]);}},fetchAndStoreSalesOrders=async(_0x1a43cf,_0xabcbd)=>{const _0x3828b2=a6_0x5c7fc1;try{console['log'](_0x3828b2(0x193));const _0x218a2e=await fetchSAPSalesOrders();if(!_0x218a2e||typeof _0x218a2e!==_0x3828b2(0x188)||!_0x218a2e['d']||!Array[_0x3828b2(0x183)](_0x218a2e['d'][_0x3828b2(0x1b3)])){console[_0x3828b2(0x196)](_0x3828b2(0x19b),JSON['stringify'](_0x218a2e)[_0x3828b2(0x199)](0x0,0xa)+'...');if(_0xabcbd)return _0xabcbd[_0x3828b2(0x1bb)](0x190)[_0x3828b2(0x198)]({'message':'Invalid\x20data\x20format\x20received\x20from\x20SAP'});throw new Error(_0x3828b2(0x1b6));}console['log'](_0x3828b2(0x1a5)+_0x218a2e['d'][_0x3828b2(0x1b3)]['length']+'\x20sales\x20orders\x20from\x20API');const _0x416e8e=_0x218a2e['d'][_0x3828b2(0x1b3)]['map']((_0x2c6859,_0x451eb1)=>{const _0xdc50a6=_0x3828b2;if(!_0x2c6859||typeof _0x2c6859!==_0xdc50a6(0x188))return console[_0xdc50a6(0x196)](_0xdc50a6(0x1a2)+_0x451eb1+':',_0x2c6859),null;return{'Vtweg':String(_0x2c6859?.[_0xdc50a6(0x17e)]||''),'Posnr':String(_0x2c6859?.[_0xdc50a6(0x1a3)]||''),'Bzirk':String(_0x2c6859?.[_0xdc50a6(0x192)]||''),'Vbeln':String(_0x2c6859?.[_0xdc50a6(0x18f)]||''),'Spart':String(_0x2c6859?.[_0xdc50a6(0x1ca)]||''),'Gjahr':parseInt(_0x2c6859?.['Gjahr'])||null,'Bztxt':String(_0x2c6859?.['Bztxt']||''),'Vtext':String(_0x2c6859?.[_0xdc50a6(0x19f)]||''),'PlannedOrder':convertToDecimal(_0x2c6859?.[_0xdc50a6(0x18a)]),'Kunnr':String(_0x2c6859?.[_0xdc50a6(0x197)]||''),'TotalInvoice':convertToDecimal(_0x2c6859?.['TotalInvoice']),'Erdat':convertSAPDateTime(_0x2c6859?.[_0xdc50a6(0x1b4)]),'Zone':String(_0x2c6859?.[_0xdc50a6(0x1ac)]||''),'Auart':String(_0x2c6859?.['Auart']||''),'Kursk':convertToDecimal(_0x2c6859?.[_0xdc50a6(0x1a7)],0x5),'Vkorg':String(_0x2c6859?.['Vkorg']||''),'Netwr':convertToDecimal(_0x2c6859?.['Netwr'],0x2),'Waerk':String(_0x2c6859?.['Waerk']||''),'Matnr':String(_0x2c6859?.[_0xdc50a6(0x1a6)]||''),'Matkl':String(_0x2c6859?.['Matkl']||''),'Wgbez':String(_0x2c6859?.[_0xdc50a6(0x1ad)]||'')};})[_0x3828b2(0x180)](Boolean);console[_0x3828b2(0x1c6)](_0x3828b2(0x181),JSON[_0x3828b2(0x1c3)](_0x416e8e,null,0x2));const _0x270fa7=await insertOrUpdateSalesOrders(_0x416e8e);if(!_0x270fa7||typeof _0x270fa7!==_0x3828b2(0x188)||!_0x270fa7['success']){console['error'](_0x3828b2(0x1c7),_0x270fa7?.[_0x3828b2(0x196)]||'Unexpected\x20database\x20response');if(_0xabcbd)return _0xabcbd['status'](0x1f4)[_0x3828b2(0x198)]({'message':_0x3828b2(0x1c4),'error':_0x270fa7?.[_0x3828b2(0x196)]||'Database\x20error'});throw new Error(_0x3828b2(0x1ba));}console[_0x3828b2(0x1c6)](_0x3828b2(0x1a0));if(_0xabcbd)return _0xabcbd[_0x3828b2(0x1bb)](0xc8)[_0x3828b2(0x198)]({'message':_0x3828b2(0x189),'insertedRows':_0x270fa7[_0x3828b2(0x1c5)][_0x3828b2(0x1ab)],'updatedRows':_0x270fa7['processedRows'][_0x3828b2(0x1ab)],'failedRows':_0x270fa7[_0x3828b2(0x185)][_0x3828b2(0x1ab)],'errors':_0x270fa7[_0x3828b2(0x185)]});return{'success':!![],'message':'Sales\x20orders\x20synced\x20successfully'};}catch(_0x4be560){return console[_0x3828b2(0x196)]('‚ùå\x20Error\x20syncing\x20sales\x20order\x20data:',_0x4be560[_0x3828b2(0x19c)]),_0xabcbd?_0xabcbd['status'](0x1f4)[_0x3828b2(0x198)]({'message':_0x3828b2(0x1b5),'error':_0x4be560[_0x3828b2(0x19c)]}):{'success':![],'error':_0x4be560[_0x3828b2(0x19c)]};}};module[a6_0x5c7fc1(0x1be)]={'fetchAndStoreSalesOrders':fetchAndStoreSalesOrders};