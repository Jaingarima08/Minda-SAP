const a6_0x2074d4=a6_0x126c;(function(_0x221560,_0xf67fc4){const _0x3bf75f=a6_0x126c,_0x22b91a=_0x221560();while(!![]){try{const _0x321a8e=parseInt(_0x3bf75f(0x108))/0x1+-parseInt(_0x3bf75f(0xfa))/0x2+-parseInt(_0x3bf75f(0x114))/0x3+-parseInt(_0x3bf75f(0x12b))/0x4+-parseInt(_0x3bf75f(0x11e))/0x5*(parseInt(_0x3bf75f(0x120))/0x6)+parseInt(_0x3bf75f(0xf9))/0x7*(parseInt(_0x3bf75f(0x110))/0x8)+-parseInt(_0x3bf75f(0x135))/0x9*(-parseInt(_0x3bf75f(0x145))/0xa);if(_0x321a8e===_0xf67fc4)break;else _0x22b91a['push'](_0x22b91a['shift']());}catch(_0xdc41e3){_0x22b91a['push'](_0x22b91a['shift']());}}}(a6_0x5437,0xcaa6d));function a6_0x5437(){const _0x35f636=['status','PlannedOrder','map','getSeconds','isArray','success','üìå\x20Final\x20Data\x20Before\x20Insert/Update:','140VCsfuF','SAP_USERNAME','149964pBOgRl','Sales_Order_API','string','slice','exports','axios','...','Vbeln','SAP_PASSWORD','TotalInvoice','Erdat','6424984OznMOk','getHours','error','warn','Matkl','data','‚ùå\x20Error\x20processing\x20sales\x20order\x20data:','Error\x20inserting\x20or\x20updating\x20sales\x20order\x20data','stringify','Waerk','9EmeNWu','0.00','toString','Bzirk','üìå\x20API\x20Response\x20Data:','json','\x20sales\x20orders\x20from\x20API','Vtext','message','getMinutes','object','‚ùå\x20API\x20Response\x20Format\x20Incorrect:','log','‚ùå\x20Error\x20fetching\x20SAP\x20sales\x20order\x20data:','getMonth','get','9669750pKivdI','getFullYear','Wgbez','105arxAvT','138516NFPJpp','Spart','processedRows','Bztxt','‚ùå\x20Skipping\x20invalid\x20entry\x20at\x20index\x20','Zone','‚ö†Ô∏è\x20Received\x20empty\x20response\x20from\x20API','Sales\x20orders\x20synced\x20successfully','dotenv','Empty\x20response\x20from\x20API','Vtweg','üîç\x20Fetching\x20Sales\x20Order\x20Data\x20from\x20API:','results','../models/salesOrderModel','1153049wHIRGw','env','Database\x20error','replace','getDate','Posnr','toFixed','length','795104PFkote','MonthD','Vkorg','application/json','1216341kthwUj','Invalid\x20data\x20format\x20received\x20from\x20SAP','failedRows'];a6_0x5437=function(){return _0x35f636;};return a6_0x5437();}const axios=require(a6_0x2074d4(0x125)),{insertOrUpdateSalesOrders}=require(a6_0x2074d4(0x107));require(a6_0x2074d4(0x102))['config']();const API_URL=process['env'][a6_0x2074d4(0x121)],convertSAPDateTime=_0x2412bd=>{const _0xe66f52=a6_0x2074d4;if(!_0x2412bd||typeof _0x2412bd!==_0xe66f52(0x122))return null;const _0x5ab609=_0x2412bd['match'](/\/Date\((\d+)(?:[+-]\d+)?\)\//);if(!_0x5ab609)return null;const _0x516d22=parseInt(_0x5ab609[0x1],0xa),_0x732cc5=new Date(_0x516d22),_0x140cf8=_0x414dfd=>_0x414dfd[_0xe66f52(0x137)]()['padStart'](0x2,'0'),_0x5c860d=_0x732cc5[_0xe66f52(0x146)]()+'-'+_0x140cf8(_0x732cc5[_0xe66f52(0x143)]()+0x1)+'-'+_0x140cf8(_0x732cc5[_0xe66f52(0x10c)]())+'\x20'+(_0x140cf8(_0x732cc5[_0xe66f52(0x12c)]())+':'+_0x140cf8(_0x732cc5[_0xe66f52(0x13e)]())+':'+_0x140cf8(_0x732cc5[_0xe66f52(0x11a)]()));return _0x5c860d;},convertToDecimal=_0x51902b=>{const _0x1afcd9=a6_0x2074d4;if(!_0x51902b||isNaN(_0x51902b))return _0x1afcd9(0x136);return parseFloat(_0x51902b[_0x1afcd9(0x137)]()[_0x1afcd9(0x10b)](',','.'))[_0x1afcd9(0x10e)](0x2);},fetchSAPSalesOrders=async()=>{const _0x330c4c=a6_0x2074d4;try{console['log'](_0x330c4c(0x105),API_URL);const _0x2cd2a9=await axios[_0x330c4c(0x144)](API_URL,{'auth':{'username':process[_0x330c4c(0x109)][_0x330c4c(0x11f)],'password':process['env'][_0x330c4c(0x128)]},'headers':{'Accept':_0x330c4c(0x113)}});if(!_0x2cd2a9['data']){console[_0x330c4c(0x12e)](_0x330c4c(0x100));throw new Error(_0x330c4c(0x103));}return console[_0x330c4c(0x141)]('‚úÖ\x20API\x20Response\x20Received.\x20Length:',JSON['stringify'](_0x2cd2a9['data'])[_0x330c4c(0x10f)]),console[_0x330c4c(0x141)](_0x330c4c(0x139),JSON['stringify'](_0x2cd2a9[_0x330c4c(0x130)],null,0x2)),_0x2cd2a9[_0x330c4c(0x130)];}catch(_0x12dd23){console['error'](_0x330c4c(0x142),_0x12dd23['message']);throw new Error('SAP\x20API\x20Error:\x20'+_0x12dd23[_0x330c4c(0x13d)]);}},fetchAndStoreSalesOrders=async(_0x22e2e1,_0x4efb58)=>{const _0x3f1af0=a6_0x2074d4;try{console['log']('üöÄ\x20Starting\x20Sales\x20Order\x20Data\x20Sync...');const _0x30117e=await fetchSAPSalesOrders();if(!_0x30117e||typeof _0x30117e!==_0x3f1af0(0x13f)||!_0x30117e['d']||!Array[_0x3f1af0(0x11b)](_0x30117e['d'][_0x3f1af0(0x106)])){console[_0x3f1af0(0x12d)](_0x3f1af0(0x140),JSON[_0x3f1af0(0x133)](_0x30117e)[_0x3f1af0(0x123)](0x0,0xa)+_0x3f1af0(0x126));if(_0x4efb58)return _0x4efb58[_0x3f1af0(0x117)](0x190)['json']({'message':'Invalid\x20data\x20format\x20received\x20from\x20SAP'});throw new Error(_0x3f1af0(0x115));}console['log']('üì¶\x20Received\x20'+_0x30117e['d'][_0x3f1af0(0x106)][_0x3f1af0(0x10f)]+_0x3f1af0(0x13b));const _0x5c9748=_0x30117e['d'][_0x3f1af0(0x106)][_0x3f1af0(0x119)]((_0x5c9d73,_0x4159df)=>{const _0xb1a665=_0x3f1af0;if(!_0x5c9d73||typeof _0x5c9d73!==_0xb1a665(0x13f))return console['error'](_0xb1a665(0xfe)+_0x4159df+':',_0x5c9d73),null;return{'Vtweg':String(_0x5c9d73?.[_0xb1a665(0x104)]||''),'Posnr':String(_0x5c9d73?.[_0xb1a665(0x10d)]||''),'Bzirk':String(_0x5c9d73?.[_0xb1a665(0x138)]||''),'Vbeln':String(_0x5c9d73?.[_0xb1a665(0x127)]||''),'Spart':String(_0x5c9d73?.[_0xb1a665(0xfb)]||''),'Gjahr':parseInt(_0x5c9d73?.['Gjahr'])||null,'Bztxt':String(_0x5c9d73?.[_0xb1a665(0xfd)]||''),'Vtext':String(_0x5c9d73?.[_0xb1a665(0x13c)]||''),'PlannedOrder':convertToDecimal(_0x5c9d73?.[_0xb1a665(0x118)]),'Kunnr':String(_0x5c9d73?.['Kunnr']||''),'TotalInvoice':convertToDecimal(_0x5c9d73?.[_0xb1a665(0x129)]),'Erdat':convertSAPDateTime(_0x5c9d73?.[_0xb1a665(0x12a)]),'Zone':String(_0x5c9d73?.[_0xb1a665(0xff)]||''),'Auart':String(_0x5c9d73?.['Auart']||''),'Kursk':convertToDecimal(_0x5c9d73?.['Kursk'],0x5),'Vkorg':String(_0x5c9d73?.[_0xb1a665(0x112)]||''),'Netwr':convertToDecimal(_0x5c9d73?.['Netwr'],0x2),'Waerk':String(_0x5c9d73?.[_0xb1a665(0x134)]||''),'Matnr':String(_0x5c9d73?.['Matnr']||''),'Matkl':String(_0x5c9d73?.[_0xb1a665(0x12f)]||''),'Wgbez':String(_0x5c9d73?.[_0xb1a665(0xf8)]||''),'MonthD':String(_0x5c9d73?.[_0xb1a665(0x111)]||''),'MonthDesc':String(_0x5c9d73?.['MonthDesc']||'')};})['filter'](Boolean);console['log'](_0x3f1af0(0x11d),JSON[_0x3f1af0(0x133)](_0x5c9748,null,0x2));const _0x445aa6=await insertOrUpdateSalesOrders(_0x5c9748);if(!_0x445aa6||typeof _0x445aa6!==_0x3f1af0(0x13f)||!_0x445aa6[_0x3f1af0(0x11c)]){console[_0x3f1af0(0x12d)](_0x3f1af0(0x131),_0x445aa6?.['error']||'Unexpected\x20database\x20response');if(_0x4efb58)return _0x4efb58['status'](0x1f4)[_0x3f1af0(0x13a)]({'message':_0x3f1af0(0x132),'error':_0x445aa6?.['error']||_0x3f1af0(0x10a)});throw new Error('Database\x20error\x20occurred\x20while\x20inserting/updating\x20sales\x20orders.');}console[_0x3f1af0(0x141)]('‚úÖ\x20Sales\x20Order\x20Data\x20Sync\x20Completed\x20Successfully');if(_0x4efb58)return _0x4efb58['status'](0xc8)[_0x3f1af0(0x13a)]({'message':'‚úÖ\x20Sales\x20order\x20data\x20inserted/updated\x20successfully','insertedRows':_0x445aa6[_0x3f1af0(0xfc)][_0x3f1af0(0x10f)],'updatedRows':_0x445aa6[_0x3f1af0(0xfc)]['length'],'failedRows':_0x445aa6['failedRows'][_0x3f1af0(0x10f)],'errors':_0x445aa6[_0x3f1af0(0x116)]});return{'success':!![],'message':_0x3f1af0(0x101)};}catch(_0x319e0b){return console[_0x3f1af0(0x12d)]('‚ùå\x20Error\x20syncing\x20sales\x20order\x20data:',_0x319e0b[_0x3f1af0(0x13d)]),_0x4efb58?_0x4efb58['status'](0x1f4)[_0x3f1af0(0x13a)]({'message':'Internal\x20Server\x20Error','error':_0x319e0b[_0x3f1af0(0x13d)]}):{'success':![],'error':_0x319e0b[_0x3f1af0(0x13d)]};}};function a6_0x126c(_0x752fd,_0x3f5ab0){const _0x5437d0=a6_0x5437();return a6_0x126c=function(_0x126c17,_0x30f475){_0x126c17=_0x126c17-0xf8;let _0x37c2a3=_0x5437d0[_0x126c17];return _0x37c2a3;},a6_0x126c(_0x752fd,_0x3f5ab0);}module[a6_0x2074d4(0x124)]={'fetchAndStoreSalesOrders':fetchAndStoreSalesOrders};