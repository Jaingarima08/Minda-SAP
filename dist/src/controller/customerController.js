const a2_0x1302b6=a2_0x5b5e;(function(_0x8b9055,_0x47f3b5){const _0x33129d=a2_0x5b5e,_0x4b0fa6=_0x8b9055();while(!![]){try{const _0x15e982=-parseInt(_0x33129d(0x1d4))/0x1+-parseInt(_0x33129d(0x1fa))/0x2*(parseInt(_0x33129d(0x1df))/0x3)+-parseInt(_0x33129d(0x1ef))/0x4*(-parseInt(_0x33129d(0x1d9))/0x5)+-parseInt(_0x33129d(0x1ec))/0x6+parseInt(_0x33129d(0x1da))/0x7+-parseInt(_0x33129d(0x1ce))/0x8*(parseInt(_0x33129d(0x1cd))/0x9)+parseInt(_0x33129d(0x1f4))/0xa;if(_0x15e982===_0x47f3b5)break;else _0x4b0fa6['push'](_0x4b0fa6['shift']());}catch(_0x585509){_0x4b0fa6['push'](_0x4b0fa6['shift']());}}}(a2_0x3698,0x736f2));function a2_0x5b5e(_0x109b65,_0x553b18){const _0x369841=a2_0x3698();return a2_0x5b5e=function(_0x5b5eca,_0x58fe57){_0x5b5eca=_0x5b5eca-0x1c7;let _0x326cde=_0x369841[_0x5b5eca];return _0x326cde;},a2_0x5b5e(_0x109b65,_0x553b18);}const axios=require(a2_0x1302b6(0x1cf)),{upsertCustomer}=require(a2_0x1302b6(0x1f2));require('dotenv')[a2_0x1302b6(0x1db)]();function a2_0x3698(){const _0x105be7=['isArray','ðŸ“Œ\x20Final\x20Data\x20Before\x20Upsertion:','ðŸ“¦\x20Received\x20','âŒ\x20Error\x20syncing\x20customer\x20data:','Unexpected\x20database\x20response','2XDioZE','Bztxt','âŒ\x20Error\x20fetching\x20SAP\x20customer\x20data:','log','results','Invalid\x20data\x20format\x20received\x20from\x20SAP','slice','map','9cfrkCA','446568PzpmwR','axios','âš ï¸\x20Received\x20empty\x20response\x20from\x20API','CUSTOMER_API','failedRows','\x20customers\x20from\x20API','494049RikSIS','Vkorg','âœ…\x20API\x20Response\x20Received.\x20Length:','\x20API\x20Response\x20Data:','Error\x20insering\x20or\x20updating\x20customer\x20data','72735BpxTOm','2475137fAXnzd','config','ðŸš€\x20Starting\x20Customer\x20Data\x20Sync...','Zone','Kunnr','111429OZXMBr','length','data','message','Bzirk','object','stringify','Database\x20error','status','Internal\x20Server\x20Error','...','Empty\x20response\x20from\x20API','json','2546988JjsvZY','processedRows','env','148KGmxyI','warn','error','../models/customerModel','get','5924990LQbWOs'];a2_0x3698=function(){return _0x105be7;};return a2_0x3698();}const API_URL=process[a2_0x1302b6(0x1ee)][a2_0x1302b6(0x1d1)],fetchSAPCustomers=async()=>{const _0x215d89=a2_0x1302b6;try{console[_0x215d89(0x1c8)]('ðŸ”\x20Fetching\x20Customer\x20Data\x20from\x20API:',API_URL);const _0x3ee2db=await axios[_0x215d89(0x1f3)](API_URL,{'auth':{'username':process[_0x215d89(0x1ee)]['SAP_USERNAME'],'password':process['env']['SAP_PASSWORD']},'headers':{'Accept':'application/json'},'responseType':_0x215d89(0x1eb)});if(!_0x3ee2db['data']){console[_0x215d89(0x1f0)](_0x215d89(0x1d0));throw new Error(_0x215d89(0x1ea));}return console['log'](_0x215d89(0x1d6),JSON[_0x215d89(0x1e5)](_0x3ee2db[_0x215d89(0x1e1)])[_0x215d89(0x1e0)]),console[_0x215d89(0x1c8)](_0x215d89(0x1d7),JSON['stringify'](_0x3ee2db[_0x215d89(0x1e1)],null,0x2)),_0x3ee2db[_0x215d89(0x1e1)];}catch(_0x28578f){console[_0x215d89(0x1f1)](_0x215d89(0x1c7),_0x28578f['message']);throw new Error('SAP\x20API\x20Error:\x20'+_0x28578f[_0x215d89(0x1e2)]);}},fetchAndStoreCustomers=async(_0x545dc6,_0xb3504d)=>{const _0x5bf54c=a2_0x1302b6;try{console['log'](_0x5bf54c(0x1dc));const _0x458a40=await fetchSAPCustomers();if(!_0x458a40||typeof _0x458a40!==_0x5bf54c(0x1e4)||!_0x458a40['d']||!Array[_0x5bf54c(0x1f5)](_0x458a40['d'][_0x5bf54c(0x1c9)]))return console['error']('âŒ\x20API\x20Response\x20Format\x20Incorrect:',JSON[_0x5bf54c(0x1e5)](_0x458a40)[_0x5bf54c(0x1cb)](0x0,0xa)+_0x5bf54c(0x1e9)),_0xb3504d[_0x5bf54c(0x1e7)](0x190)[_0x5bf54c(0x1eb)]({'message':_0x5bf54c(0x1ca)});console['log'](_0x5bf54c(0x1f7)+_0x458a40['d'][_0x5bf54c(0x1c9)]['length']+_0x5bf54c(0x1d3));const _0x3e3a1d=_0x458a40['d'][_0x5bf54c(0x1c9)][_0x5bf54c(0x1cc)]((_0x3d8663,_0x368d5d)=>{const _0x8b04b7=_0x5bf54c;return console[_0x8b04b7(0x1c8)]('ðŸ”„\x20Processing\x20Customer\x20'+(_0x368d5d+0x1)+':',_0x3d8663['Kunnr']),{'Kunnr':String(_0x3d8663[_0x8b04b7(0x1de)]),'Zone':String(_0x3d8663[_0x8b04b7(0x1dd)]),'Vkorg':String(_0x3d8663[_0x8b04b7(0x1d5)]),'Bzirk':String(_0x3d8663[_0x8b04b7(0x1e3)]||''),'Name1':String(_0x3d8663['Name1']),'Bztxt':String(_0x3d8663[_0x8b04b7(0x1fb)]||'')};})['filter'](Boolean);console[_0x5bf54c(0x1c8)](_0x5bf54c(0x1f6),JSON['stringify'](_0x3e3a1d,null,0x2));const _0x309c04=await upsertCustomer(_0x3e3a1d);if(!_0x309c04||typeof _0x309c04!==_0x5bf54c(0x1e4)||!_0x309c04['success']){console[_0x5bf54c(0x1f1)]('\x20Error\x20inserted\x20or\x20updating\x20customer\x20data:',_0x309c04?.[_0x5bf54c(0x1f1)]||_0x5bf54c(0x1f9));if(_0xb3504d)return _0xb3504d['status'](0x1f4)[_0x5bf54c(0x1eb)]({'message':_0x5bf54c(0x1d8),'error':_0x309c04?.[_0x5bf54c(0x1f1)]||_0x5bf54c(0x1e6)});return;}console['log']('âœ…\x20Customer\x20Data\x20Sync\x20Completed\x20Successfully\x20');if(_0xb3504d)return _0xb3504d[_0x5bf54c(0x1e7)](0xc8)[_0x5bf54c(0x1eb)]({'message':'\x20Customer\x20data\x20synced\x20successfully','insertedRows':_0x309c04[_0x5bf54c(0x1ed)][_0x5bf54c(0x1e0)],'updatedRows':_0x309c04[_0x5bf54c(0x1ed)]['length'],'failedRows':_0x309c04[_0x5bf54c(0x1d2)][_0x5bf54c(0x1e0)],'errors':_0x309c04[_0x5bf54c(0x1d2)]});}catch(_0x33df03){console[_0x5bf54c(0x1f1)](_0x5bf54c(0x1f8),_0x33df03['message']);if(_0xb3504d)return _0xb3504d['status'](0x1f4)[_0x5bf54c(0x1eb)]({'message':_0x5bf54c(0x1e8),'error':_0x33df03['message']});}};module['exports']={'fetchAndStoreCustomers':fetchAndStoreCustomers};