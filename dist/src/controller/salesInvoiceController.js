const a5_0x244301=a5_0x39b7;(function(_0x37fbd2,_0x3d712c){const _0x157170=a5_0x39b7,_0x2df5bd=_0x37fbd2();while(!![]){try{const _0x39e1c3=-parseInt(_0x157170(0x15a))/0x1+-parseInt(_0x157170(0x148))/0x2+parseInt(_0x157170(0x145))/0x3+-parseInt(_0x157170(0x115))/0x4*(parseInt(_0x157170(0x119))/0x5)+parseInt(_0x157170(0x13b))/0x6+-parseInt(_0x157170(0x130))/0x7+-parseInt(_0x157170(0x14d))/0x8*(-parseInt(_0x157170(0x13f))/0x9);if(_0x39e1c3===_0x3d712c)break;else _0x2df5bd['push'](_0x2df5bd['shift']());}catch(_0x5cd57b){_0x2df5bd['push'](_0x2df5bd['shift']());}}}(a5_0x38e7,0x3156d));const axios=require(a5_0x244301(0x151)),{insertOrUpdateSalesInvoices}=require(a5_0x244301(0x15d));require('dotenv')[a5_0x244301(0x117)]();const API_URL=process[a5_0x244301(0x158)][a5_0x244301(0x12c)],convertSAPDateTime=_0x384ae4=>{const _0x16781c=a5_0x244301;if(!_0x384ae4||!_0x384ae4[_0x16781c(0x124)](/\d+/))return null;const _0x40bf89=parseInt(_0x384ae4['match'](/\d+/)[0x0],0xa);return new Date(_0x40bf89)['toISOString']()[_0x16781c(0x120)]('T','\x20')[_0x16781c(0x137)]('.')[0x0];},convertToDecimal=_0x149b73=>{const _0x4348fa=a5_0x244301;if(!_0x149b73||isNaN(_0x149b73))return 0x0;return parseFloat(_0x149b73[_0x4348fa(0x133)]()[_0x4348fa(0x120)](',','.'));},fetchSAPSalesInvoices=async()=>{const _0x417e80=a5_0x244301;try{console['log']('üîç\x20Fetching\x20Sales\x20Invoice\x20Data\x20from\x20API:',API_URL);const _0x5af173=await axios[_0x417e80(0x156)](API_URL,{'auth':{'username':process[_0x417e80(0x158)]['SAP_USERNAME'],'password':process[_0x417e80(0x158)][_0x417e80(0x13e)]},'headers':{'Accept':'application/json'},'responseType':'json'});if(!_0x5af173[_0x417e80(0x146)]){console['warn'](_0x417e80(0x14b));throw new Error('Empty\x20response\x20from\x20API');}console[_0x417e80(0x14f)](_0x417e80(0x15c),JSON[_0x417e80(0x125)](_0x5af173[_0x417e80(0x146)])['length']),console['log'](_0x417e80(0x14e),JSON['stringify'](_0x5af173[_0x417e80(0x146)],null,0x2));if(!_0x5af173[_0x417e80(0x146)]['d']||!Array[_0x417e80(0x121)](_0x5af173[_0x417e80(0x146)]['d'][_0x417e80(0x11a)])){console['error'](_0x417e80(0x138),JSON[_0x417e80(0x125)](_0x5af173['data'])[_0x417e80(0x135)](0x0,0xc8)+_0x417e80(0x147));throw new Error(_0x417e80(0x155));}const _0x6d66cb=_0x5af173[_0x417e80(0x146)]['d'][_0x417e80(0x11a)]||[];return console[_0x417e80(0x14f)](_0x417e80(0x144)+_0x6d66cb[_0x417e80(0x134)]+_0x417e80(0x11e)),_0x6d66cb;}catch(_0xd07f0a){console[_0x417e80(0x13c)]('‚ùå\x20Error\x20fetching\x20SAP\x20sales\x20invoice\x20data:',_0xd07f0a[_0x417e80(0x132)]);throw new Error(_0x417e80(0x129)+_0xd07f0a['message']);}},fetchAndStoreSalesInvoices=async(_0x410fcf,_0x1aaefc)=>{const _0x676761=a5_0x244301;try{console['log'](_0x676761(0x142));const _0x5eee27=await fetchSAPSalesInvoices();if(!Array[_0x676761(0x121)](_0x5eee27)||_0x5eee27[_0x676761(0x134)]===0x0){console['warn']('‚ö†Ô∏è\x20No\x20valid\x20sales\x20invoice\x20data\x20received.');if(_0x1aaefc)return _0x1aaefc[_0x676761(0x123)](0x190)['json']({'message':_0x676761(0x150)});return;}console[_0x676761(0x14f)](_0x676761(0x15b)+_0x5eee27[_0x676761(0x134)]+_0x676761(0x14a));const _0x3707f9=_0x5eee27[_0x676761(0x122)]((_0x442da4,_0x28a6c3)=>{const _0x209b7a=_0x676761;if(!_0x442da4||typeof _0x442da4!==_0x209b7a(0x12d))return console[_0x209b7a(0x13c)](_0x209b7a(0x131)+_0x28a6c3+':',_0x442da4),null;return{'Vbeln':String(_0x442da4?.['Vbeln']||''),'Posnr':String(_0x442da4?.[_0x209b7a(0x128)]||''),'Matnr':String(_0x442da4?.['Matnr']||''),'PlannedOrder':convertToDecimal(_0x442da4?.[_0x209b7a(0x140)]),'Wgbez':String(_0x442da4?.[_0x209b7a(0x126)]||''),'Bzirk':String(_0x442da4?.['Bzirk']||''),'Netwr':convertToDecimal(_0x442da4?.[_0x209b7a(0x153)]),'Vtweg':String(_0x442da4?.[_0x209b7a(0x139)]||''),'Matkl':String(_0x442da4?.[_0x209b7a(0x143)]||''),'TotalInvoice':convertToDecimal(_0x442da4?.[_0x209b7a(0x12a)]),'Spart':String(_0x442da4?.[_0x209b7a(0x11f)]||''),'Zone':String(_0x442da4?.[_0x209b7a(0x12e)]||''),'Fkart':String(_0x442da4?.[_0x209b7a(0x13a)]||''),'Kunag':String(_0x442da4?.[_0x209b7a(0x157)]||''),'Fktyp':String(_0x442da4?.[_0x209b7a(0x149)]||''),'Aupos':String(_0x442da4?.[_0x209b7a(0x12b)]||''),'Werks':String(_0x442da4?.[_0x209b7a(0x114)]||''),'Vkorg':String(_0x442da4?.['Vkorg']||''),'Waerk':String(_0x442da4?.[_0x209b7a(0x14c)]||''),'Gjahr':String(_0x442da4?.['Gjahr']||''),'Fkdat':convertSAPDateTime(_0x442da4?.[_0x209b7a(0x159)]),'Aubel':String(_0x442da4?.['Aubel']||'')};})[_0x676761(0x12f)](Boolean);console['log'](_0x676761(0x11b),JSON['stringify'](_0x3707f9,null,0x2));const _0xe3ace7=await insertOrUpdateSalesInvoices(_0x3707f9);if(!_0xe3ace7||typeof _0xe3ace7!==_0x676761(0x12d)||!_0xe3ace7[_0x676761(0x127)]){console[_0x676761(0x13c)]('‚ùå\x20Error\x20inserting\x20or\x20updating\x20sales\x20invoice\x20data:',_0xe3ace7?.[_0x676761(0x13c)]||'Unexpected\x20database\x20response');if(_0x1aaefc)return _0x1aaefc[_0x676761(0x123)](0x1f4)[_0x676761(0x136)]({'message':_0x676761(0x118),'error':_0xe3ace7?.[_0x676761(0x13c)]||'Database\x20error'});return;}console[_0x676761(0x14f)](_0x676761(0x11d));if(_0x1aaefc)return _0x1aaefc['status'](0xc8)[_0x676761(0x136)]({'message':_0x676761(0x13d),'insertedRows':_0xe3ace7[_0x676761(0x11c)][_0x676761(0x134)],'updatedRows':_0xe3ace7[_0x676761(0x11c)][_0x676761(0x134)],'failedRows':_0xe3ace7[_0x676761(0x116)]['length'],'errors':_0xe3ace7['failedRows']});}catch(_0x155839){console[_0x676761(0x13c)](_0x676761(0x152),_0x155839[_0x676761(0x132)]);if(_0x1aaefc)return _0x1aaefc['status'](0x1f4)[_0x676761(0x136)]({'message':_0x676761(0x154),'error':_0x155839[_0x676761(0x132)]});}};function a5_0x39b7(_0x2c8620,_0x57d8ab){const _0x38e7bd=a5_0x38e7();return a5_0x39b7=function(_0x39b7b8,_0x50ea39){_0x39b7b8=_0x39b7b8-0x114;let _0x21cfe2=_0x38e7bd[_0x39b7b8];return _0x21cfe2;},a5_0x39b7(_0x2c8620,_0x57d8ab);}module[a5_0x244301(0x141)]={'fetchAndStoreSalesInvoices':fetchAndStoreSalesInvoices};function a5_0x38e7(){const _0x33144b=['Sales_invoice_API','object','Zone','filter','259567hVZUjS','‚ùå\x20Skipping\x20invalid\x20invoice\x20at\x20index\x20','message','toString','length','slice','json','split','‚ùå\x20API\x20Response\x20Format\x20Incorrect:','Vtweg','Fkart','1258962cPzmLH','error','‚úÖ\x20Sales\x20invoice\x20data\x20synced\x20successfully','SAP_PASSWORD','5850099lydKUn','PlannedOrder','exports','üöÄ\x20Starting\x20Sales\x20Invoice\x20Data\x20Sync...','Matkl','üì¶\x20Received\x20','510231MhidDn','data','...','571790qMNziW','Fktyp','\x20sales\x20invoices...','‚ö†Ô∏è\x20Received\x20empty\x20response\x20from\x20API','Waerk','8hFabIF','üìå\x20API\x20Response\x20Data:','log','No\x20sales\x20invoice\x20data\x20found\x20in\x20SAP','axios','‚ùå\x20Error\x20syncing\x20sales\x20invoice\x20data:','Netwr','Internal\x20Server\x20Error','Invalid\x20data\x20format\x20received\x20from\x20SAP','get','Kunag','env','Fkdat','359047KTjGKT','üì¶\x20Processing\x20','‚úÖ\x20API\x20Response\x20Received.\x20Length:','../models/salesInvoiceModel','Werks','583196mFHqzI','failedRows','config','Error\x20inserting\x20or\x20updating\x20sales\x20invoice\x20data','5xlLWEp','results','üìå\x20Final\x20Processed\x20Invoices:','processedRows','‚úÖ\x20Sales\x20Invoice\x20Data\x20Sync\x20Completed\x20Successfully','\x20sales\x20invoices','Spart','replace','isArray','map','status','match','stringify','Wgbez','success','Posnr','SAP\x20API\x20Error:\x20','TotalInvoice','Aupos'];a5_0x38e7=function(){return _0x33144b;};return a5_0x38e7();}