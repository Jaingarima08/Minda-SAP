function a4_0x67fa(_0x24dc25,_0x118433){const _0x39b1fe=a4_0x39b1();return a4_0x67fa=function(_0x67fa10,_0x234df6){_0x67fa10=_0x67fa10-0x15d;let _0x4fd84c=_0x39b1fe[_0x67fa10];return _0x4fd84c;},a4_0x67fa(_0x24dc25,_0x118433);}const a4_0x10d92c=a4_0x67fa;(function(_0xb534d5,_0xe13783){const _0x28c752=a4_0x67fa,_0x1dbd53=_0xb534d5();while(!![]){try{const _0x1184f6=parseInt(_0x28c752(0x160))/0x1*(-parseInt(_0x28c752(0x177))/0x2)+-parseInt(_0x28c752(0x163))/0x3+-parseInt(_0x28c752(0x19a))/0x4+parseInt(_0x28c752(0x1aa))/0x5+-parseInt(_0x28c752(0x18a))/0x6+-parseInt(_0x28c752(0x194))/0x7*(parseInt(_0x28c752(0x17b))/0x8)+parseInt(_0x28c752(0x18b))/0x9;if(_0x1184f6===_0xe13783)break;else _0x1dbd53['push'](_0x1dbd53['shift']());}catch(_0x545eb0){_0x1dbd53['push'](_0x1dbd53['shift']());}}}(a4_0x39b1,0xd691c));function a4_0x39b1(){const _0x5f475f=['SAP_USERNAME','json','message','Netwr','length','‚ùå\x20API\x20Response\x20Format\x20Incorrect:','Vtweg','21fgMsPK','Fktyp','dotenv','üì¶\x20Received\x20','üöÄ\x20Starting\x20Sales\x20Invoice\x20Data\x20Sync...','PlannedOrder','4840400lMZqYP','axios','Aupos','Aubel','‚úÖ\x20Sales\x20invoice\x20data\x20synced\x20successfully','‚ö†Ô∏è\x20Received\x20empty\x20response\x20from\x20API','Matnr','üîç\x20Fetching\x20Sales\x20Invoice\x20Data\x20from\x20API:','replace','‚úÖ\x20API\x20Response\x20Received.\x20Length:','TotalInvoice','Wgbez','Werks','Matkl','processedRows','Error\x20inserting\x20or\x20updating\x20sales\x20invoice\x20data','6660410xwelLn','Zone','filter','Posnr','env','SAP_PASSWORD','905DIrbwk','...','SAP\x20API\x20Error:\x20','4693578dMYbul','Vbeln','isArray','exports','status','../models/salesInvoiceModel','Gjahr','‚úÖ\x20Sales\x20Invoice\x20Data\x20Sync\x20Completed\x20Successfully','üìå\x20Final\x20Processed\x20Invoices:','get','application/json','Bzirk','failedRows','üìå\x20API\x20Response\x20Data:','warn','üì¶\x20Processing\x20','config','‚ùå\x20Error\x20fetching\x20SAP\x20sales\x20invoice\x20data:','object','\x20sales\x20invoices...','1622EvdjBz','stringify','split','Vkorg','1706536ldodxf','Kunag','Sales_invoice_API','toString','Fkart','‚ùå\x20Error\x20inserting\x20or\x20updating\x20sales\x20invoice\x20data:','Database\x20error','data','No\x20sales\x20invoice\x20data\x20found\x20in\x20SAP','match','log','error','results','\x20sales\x20invoices','Spart','2680236mQivam','37278288ZKhUOv','success'];a4_0x39b1=function(){return _0x5f475f;};return a4_0x39b1();}const axios=require(a4_0x10d92c(0x19b)),{insertOrUpdateSalesInvoices}=require(a4_0x10d92c(0x168));require(a4_0x10d92c(0x196))[a4_0x10d92c(0x173)]();const API_URL=process[a4_0x10d92c(0x15e)][a4_0x10d92c(0x17d)],convertSAPDateTime=_0x2349e7=>{const _0x2f71c5=a4_0x10d92c;if(!_0x2349e7||!_0x2349e7[_0x2f71c5(0x184)](/\d+/))return null;const _0x32b4e6=parseInt(_0x2349e7[_0x2f71c5(0x184)](/\d+/)[0x0],0xa);return new Date(_0x32b4e6)['toISOString']()[_0x2f71c5(0x1a2)]('T','\x20')[_0x2f71c5(0x179)]('.')[0x0];},convertToDecimal=_0x1bbda1=>{const _0x2f588b=a4_0x10d92c;if(!_0x1bbda1||isNaN(_0x1bbda1))return 0x0;return parseFloat(_0x1bbda1[_0x2f588b(0x17e)]()[_0x2f588b(0x1a2)](',','.'));},fetchSAPSalesInvoices=async()=>{const _0x41a514=a4_0x10d92c;try{console[_0x41a514(0x185)](_0x41a514(0x1a1),API_URL);const _0x1876aa=await axios[_0x41a514(0x16c)](API_URL,{'auth':{'username':process[_0x41a514(0x15e)][_0x41a514(0x18d)],'password':process['env'][_0x41a514(0x15f)]},'headers':{'Accept':_0x41a514(0x16d)},'responseType':_0x41a514(0x18e)});if(!_0x1876aa[_0x41a514(0x182)]){console[_0x41a514(0x171)](_0x41a514(0x19f));throw new Error('Empty\x20response\x20from\x20API');}console['log'](_0x41a514(0x1a3),JSON['stringify'](_0x1876aa[_0x41a514(0x182)])[_0x41a514(0x191)]),console[_0x41a514(0x185)](_0x41a514(0x170),JSON[_0x41a514(0x178)](_0x1876aa['data'],null,0x2));if(!_0x1876aa[_0x41a514(0x182)]['d']||!Array[_0x41a514(0x165)](_0x1876aa[_0x41a514(0x182)]['d']['results'])){console[_0x41a514(0x186)](_0x41a514(0x192),JSON[_0x41a514(0x178)](_0x1876aa[_0x41a514(0x182)])['slice'](0x0,0xc8)+_0x41a514(0x161));throw new Error('Invalid\x20data\x20format\x20received\x20from\x20SAP');}const _0x249d96=_0x1876aa[_0x41a514(0x182)]['d'][_0x41a514(0x187)]||[];return console[_0x41a514(0x185)](_0x41a514(0x197)+_0x249d96[_0x41a514(0x191)]+_0x41a514(0x188)),_0x249d96;}catch(_0x3beaaf){console[_0x41a514(0x186)](_0x41a514(0x174),_0x3beaaf['message']);throw new Error(_0x41a514(0x162)+_0x3beaaf[_0x41a514(0x18f)]);}},fetchAndStoreSalesInvoices=async(_0x91494b,_0x120f59)=>{const _0x57d079=a4_0x10d92c;try{console[_0x57d079(0x185)](_0x57d079(0x198));const _0x301cb6=await fetchSAPSalesInvoices();if(!Array[_0x57d079(0x165)](_0x301cb6)||_0x301cb6[_0x57d079(0x191)]===0x0){console[_0x57d079(0x171)]('‚ö†Ô∏è\x20No\x20valid\x20sales\x20invoice\x20data\x20received.');if(_0x120f59)return _0x120f59[_0x57d079(0x167)](0x190)[_0x57d079(0x18e)]({'message':_0x57d079(0x183)});return;}console[_0x57d079(0x185)](_0x57d079(0x172)+_0x301cb6[_0x57d079(0x191)]+_0x57d079(0x176));const _0x34ce28=_0x301cb6['map']((_0x4b60ee,_0x581740)=>{const _0x200011=_0x57d079;if(!_0x4b60ee||typeof _0x4b60ee!==_0x200011(0x175))return console[_0x200011(0x186)]('‚ùå\x20Skipping\x20invalid\x20invoice\x20at\x20index\x20'+_0x581740+':',_0x4b60ee),null;return{'Vbeln':String(_0x4b60ee?.[_0x200011(0x164)]||''),'Posnr':String(_0x4b60ee?.[_0x200011(0x15d)]||''),'Matnr':String(_0x4b60ee?.[_0x200011(0x1a0)]||''),'PlannedOrder':convertToDecimal(_0x4b60ee?.[_0x200011(0x199)]),'Wgbez':String(_0x4b60ee?.[_0x200011(0x1a5)]||''),'Bzirk':String(_0x4b60ee?.[_0x200011(0x16e)]||''),'Netwr':convertToDecimal(_0x4b60ee?.[_0x200011(0x190)]),'Vtweg':String(_0x4b60ee?.[_0x200011(0x193)]||''),'Matkl':String(_0x4b60ee?.[_0x200011(0x1a7)]||''),'TotalInvoice':convertToDecimal(_0x4b60ee?.[_0x200011(0x1a4)]),'Spart':String(_0x4b60ee?.[_0x200011(0x189)]||''),'Zone':String(_0x4b60ee?.[_0x200011(0x1ab)]||''),'Fkart':String(_0x4b60ee?.[_0x200011(0x17f)]||''),'Kunag':String(_0x4b60ee?.[_0x200011(0x17c)]||''),'Fktyp':String(_0x4b60ee?.[_0x200011(0x195)]||''),'Aupos':String(_0x4b60ee?.[_0x200011(0x19c)]||''),'Werks':String(_0x4b60ee?.[_0x200011(0x1a6)]||''),'Vkorg':String(_0x4b60ee?.[_0x200011(0x17a)]||''),'Waerk':String(_0x4b60ee?.['Waerk']||''),'Gjahr':String(_0x4b60ee?.[_0x200011(0x169)]||''),'Fkdat':convertSAPDateTime(_0x4b60ee?.['Fkdat']),'Aubel':String(_0x4b60ee?.[_0x200011(0x19d)]||'')};})[_0x57d079(0x1ac)](Boolean);console[_0x57d079(0x185)](_0x57d079(0x16b),JSON['stringify'](_0x34ce28,null,0x2));const _0x31bc68=await insertOrUpdateSalesInvoices(_0x34ce28);if(!_0x31bc68||typeof _0x31bc68!==_0x57d079(0x175)||!_0x31bc68[_0x57d079(0x18c)]){console['error'](_0x57d079(0x180),_0x31bc68?.[_0x57d079(0x186)]||'Unexpected\x20database\x20response');if(_0x120f59)return _0x120f59['status'](0x1f4)['json']({'message':_0x57d079(0x1a9),'error':_0x31bc68?.[_0x57d079(0x186)]||_0x57d079(0x181)});return;}console[_0x57d079(0x185)](_0x57d079(0x16a));if(_0x120f59)return _0x120f59[_0x57d079(0x167)](0xc8)[_0x57d079(0x18e)]({'message':_0x57d079(0x19e),'insertedRows':_0x31bc68[_0x57d079(0x1a8)]['length'],'updatedRows':_0x31bc68[_0x57d079(0x1a8)][_0x57d079(0x191)],'failedRows':_0x31bc68[_0x57d079(0x16f)][_0x57d079(0x191)],'errors':_0x31bc68[_0x57d079(0x16f)]});}catch(_0x136d74){console[_0x57d079(0x186)]('‚ùå\x20Error\x20syncing\x20sales\x20invoice\x20data:',_0x136d74['message']);if(_0x120f59)return _0x120f59[_0x57d079(0x167)](0x1f4)[_0x57d079(0x18e)]({'message':'Internal\x20Server\x20Error','error':_0x136d74[_0x57d079(0x18f)]});}};module[a4_0x10d92c(0x166)]={'fetchAndStoreSalesInvoices':fetchAndStoreSalesInvoices};